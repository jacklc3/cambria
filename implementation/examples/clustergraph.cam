-- Two cluster graph
-- See also erdosrenyi.cam
with handler {
  newgraph(_; k) -> k (!new ()),
  newnode(g; k) -> k (!flip ()),
  isedge(gab; k) ->
    do a <- fst (snd gab) in
    do b <- snd (snd gab) in
    if a == b then return false else return true
} handle (
  -- Make a new graph, pick two nodes, and check an edge between then
  do g <- !newgraph () in
  do a <- !newnode g in
  do b <- !newnode g in
  !isedge (g, (a,b))
)
